/* Global Styles */
* {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    min-height: 100vh;
    overflow-x: hidden;
    touch-action: manipulation;
    user-select: none;
}

.container {
    max-width: 400px;
    margin: 0 auto;
    padding: 20px;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
}

/* Screen Management */
.screen {
    display: none;
    flex-direction: column;
    flex: 1;
}

.screen.active {
    display: flex;
}

/* Menu Screen Styles - Tower UI */
#menu-screen {
    background-image: url('ninja-bg.svg');
    background-repeat: no-repeat;
    background-position: center center;
    background-size: contain;
    background-attachment: fixed;
    position: relative;
}

#menu-screen::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, rgba(102, 126, 234, 0.7) 0%, rgba(118, 75, 162, 0.7) 100%);
    z-index: 1;
    pointer-events: none;
}

#menu-screen > * {
    position: relative;
    z-index: 2;
}

#menu-screen .header {
    text-align: center;
    margin-bottom: 30px;
    padding-top: 20px;
}

#menu-screen h1 {
    font-size: 2.2rem;
    margin-bottom: 10px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
}

#menu-screen p {
    font-size: 1.1rem;
    opacity: 0.9;
    margin-bottom: 15px;
}

.progress-summary {
    display: flex;
    justify-content: space-between;
    background: rgba(255, 255, 255, 0.15);
    border-radius: 15px;
    padding: 12px 20px;
    font-size: 0.9rem;
    font-weight: bold;
}

.tower-section {
    margin-bottom: 25px;
}

.tower-section h3 {
    font-size: 1.1rem;
    margin-bottom: 15px;
    text-align: center;
    opacity: 0.9;
    padding: 8px 15px;
    border-radius: 10px;
    font-weight: bold;
}

/* Theme colors for tower sections */
.tower-section.wind h3 {
    background: linear-gradient(135deg, #87CEEB 0%, #B0E0E6 100%);
    color: #003d5c;
    box-shadow: 0 4px 15px rgba(135, 206, 235, 0.4);
}

.tower-section.water h3 {
    background: linear-gradient(135deg, #006994 0%, #38BDF8 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(14, 165, 233, 0.4);
}

.tower-section.earth h3 {
    background: linear-gradient(135deg, #8B4513 0%, #D2B48C 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(139, 69, 19, 0.4);
}

.tower-section.fire h3 {
    background: linear-gradient(135deg, #DC2626 0%, #F59E0B 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(220, 38, 38, 0.4);
}

.tower-section.lightning h3 {
    background: linear-gradient(135deg, #1E1B4B 0%, #4C1D95 100%);
    color: #FBBF24;
    box-shadow: 0 4px 15px rgba(251, 191, 36, 0.4);
}

.tower-section.toxin h3 {
    background: linear-gradient(135deg, #15803D 0%, #4ADE80 100%);
    color: white;
    box-shadow: 0 4px 15px rgba(21, 128, 61, 0.4);
}

.floors-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 8px;
    margin-bottom: 15px;
}

.floor-btn {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 12px;
    padding: 12px 8px;
    color: white;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    min-height: 70px;
    justify-content: center;
    position: relative;
}

.floor-btn:hover:not(.locked) {
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.5);
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
}

.floor-btn.locked {
    background: rgba(0, 0, 0, 0.3);
    border-color: rgba(255, 255, 255, 0.1);
    opacity: 0.5;
    cursor: not-allowed;
}

.floor-btn.completed {
    background: rgba(76, 175, 80, 0.4);
    border-color: rgba(76, 175, 80, 0.6);
}

.floor-btn.current {
    background: rgba(255, 193, 7, 0.4);
    border-color: rgba(255, 193, 7, 0.6);
    animation: pulse 2s infinite;
}

.floor-btn.boss {
    background: rgba(156, 39, 176, 0.4);
    border-color: rgba(156, 39, 176, 0.6);
}

.floor-btn.boss::before {
    content: "ðŸ‘‘";
    position: absolute;
    top: -5px;
    right: -5px;
    font-size: 1.2rem;
}

@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}

.floor-number {
    font-weight: bold;
    font-size: 1rem;
}

.floor-difficulty {
    font-size: 0.7rem;
    opacity: 0.8;
}

/* Game Screen Styles */
.game-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 30px;
    padding: 10px 0;
}

.back-btn {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    padding: 10px 15px;
    border-radius: 10px;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
}

.back-btn:hover, .back-btn:active {
    background: rgba(255, 255, 255, 0.3);
}

.game-info {
    text-align: center;
}

.floor-info {
    display: flex;
    flex-direction: column;
    gap: 5px;
    align-items: center;
}

.floor-info span {
    font-size: 1rem;
    font-weight: bold;
}

.boss-badge {
    background: rgba(156, 39, 176, 0.8);
    padding: 4px 8px;
    border-radius: 8px;
    font-size: 0.8rem !important;
    animation: boss-glow 2s infinite;
}

@keyframes boss-glow {
    0%, 100% { box-shadow: 0 0 5px rgba(156, 39, 176, 0.5); }
    50% { box-shadow: 0 0 15px rgba(156, 39, 176, 0.8); }
}

#turn-indicator {
    font-size: 1.1rem;
    font-weight: bold;
    margin-top: 10px;
}

/* Tic Tac Toe Board */
.ttt-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
    gap: 8px;
    aspect-ratio: 1;
    margin: 20px 0;
    background: rgba(0, 0, 0, 0.2);
    padding: 15px;
    border-radius: 20px;
    box-shadow: inset 0 2px 10px rgba(0,0,0,0.2);
}

/* Connect 4 Board */
.c4-grid {
    display: flex;
    gap: 4px;
    background: rgba(0, 0, 200, 0.3);
    padding: 15px;
    border-radius: 20px;
    box-shadow: inset 0 2px 10px rgba(0,0,0,0.2);
    margin: 20px 0;
    justify-content: center;
}

.c4-column {
    display: flex;
    flex-direction: column-reverse;
    gap: 4px;
    cursor: pointer;
    padding: 5px;
    border-radius: 10px;
    transition: background 0.2s ease;
}

.c4-column:hover {
    background: rgba(255, 255, 255, 0.1);
}

.c4-cell {
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.9);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: bold;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
}

.c4-cell.red {
    background: #e74c3c;
    color: white;
}

.c4-cell.yellow {
    background: #f1c40f;
    color: #333;
}

.c4-cell.winner {
    animation: c4-winner-pulse 0.6s ease;
    box-shadow: 0 0 20px rgba(241, 196, 15, 0.8);
}

.cell {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s ease;
    color: #333;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.cell:hover {
    background: rgba(255, 255, 255, 1);
    transform: scale(0.95);
}

.cell.x {
    color: #e74c3c;
}

.cell.o {
    color: #3498db;
}

.cell.winner {
    background: #f1c40f !important;
    animation: winner-pulse 0.6s ease;
}

@keyframes winner-pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* Game Controls */
.game-controls {
    display: flex;
    flex-direction: column;
    gap: 20px;
    align-items: center;
    margin-top: 20px;
}

.control-btn {
    background: rgba(255, 255, 255, 0.2);
    backdrop-filter: blur(10px);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 15px;
    padding: 15px 30px;
    color: white;
    font-size: 1.1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    min-width: 150px;
}

.control-btn:hover, .control-btn:active {
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.5);
}

.control-btn.success {
    background: rgba(76, 175, 80, 0.3);
    border-color: rgba(76, 175, 80, 0.5);
}

.control-btn.success:hover {
    background: rgba(76, 175, 80, 0.4);
    border-color: rgba(76, 175, 80, 0.7);
}

.control-btn.danger {
    background: rgba(244, 67, 54, 0.3);
    border-color: rgba(244, 67, 54, 0.5);
}

.control-btn.danger:hover {
    background: rgba(244, 67, 54, 0.4);
    border-color: rgba(244, 67, 54, 0.7);
}

@keyframes c4-winner-pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

/* Transition Effects */
.screen-transition {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 999;
}

/* Fade Transition */
.fade-transition {
    background: rgba(0, 0, 0, 0.9);
    opacity: 0;
    animation: fadeInOut 2s ease-in-out;
}

@keyframes fadeInOut {
    0% { opacity: 0; }
    50% { opacity: 1; }
    100% { opacity: 0; }
}

/* Slide Transition */
.slide-transition {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    transform: translateX(-100%);
    animation: slideAcross 2s ease-in-out;
}

@keyframes slideAcross {
    0% { transform: translateX(-100%); }
    50% { transform: translateX(0); }
    100% { transform: translateX(100%); }
}

/* Zoom Transition */
.zoom-transition {
    background: radial-gradient(circle, #667eea 0%, #764ba2 100%);
    transform: scale(0);
    border-radius: 50%;
    animation: zoomInOut 2s ease-in-out;
}

@keyframes zoomInOut {
    0% { transform: scale(0); border-radius: 50%; }
    50% { transform: scale(3); border-radius: 0%; }
    100% { transform: scale(0); border-radius: 50%; }
}

/* Spiral Transition */
.spiral-transition {
    background: conic-gradient(from 0deg, #667eea, #764ba2, #667eea);
    transform: scale(0) rotate(0deg);
    border-radius: 50%;
    animation: spiralInOut 2s ease-in-out;
}

@keyframes spiralInOut {
    0% { transform: scale(0) rotate(0deg); border-radius: 50%; }
    50% { transform: scale(2.5) rotate(720deg); border-radius: 0%; }
    100% { transform: scale(0) rotate(1440deg); border-radius: 50%; }
}

/* Wave Transition */
.wave-transition {
    background: linear-gradient(45deg, 
        transparent 40%, 
        #667eea 45%, 
        #764ba2 55%, 
        transparent 60%);
    background-size: 200% 200%;
    animation: waveAcross 2s ease-in-out;
}

@keyframes waveAcross {
    0% { background-position: -200% 0%; }
    100% { background-position: 200% 0%; }
}

/* Diamond Transition */
.diamond-transition {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    transform: rotate(45deg) scale(0);
    animation: diamondInOut 2s ease-in-out;
}

@keyframes diamondInOut {
    0% { transform: rotate(45deg) scale(0); }
    50% { transform: rotate(45deg) scale(2.5); }
    100% { transform: rotate(45deg) scale(0); }
}

/* Victory Flash Effect */
.victory-flash {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: radial-gradient(circle, 
        rgba(255, 215, 0, 0.8) 0%, 
        rgba(255, 193, 7, 0.6) 30%, 
        transparent 70%);
    pointer-events: none;
    z-index: 998;
    opacity: 0;
    animation: victoryFlash 1s ease-out;
}

@keyframes victoryFlash {
    0% { opacity: 0; transform: scale(0.5); }
    30% { opacity: 1; transform: scale(1.2); }
    60% { opacity: 0.8; transform: scale(1); }
    100% { opacity: 0; transform: scale(1.5); }
}

/* Timer Styles */
.timer-container {
    margin-top: 15px;
    padding: 10px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    text-align: center;
}

.timer-label {
    font-size: 0.9rem;
    margin-bottom: 8px;
    opacity: 0.9;
}

.timer-display {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
}

#timer-text {
    font-size: 2rem;
    font-weight: bold;
    color: #4CAF50;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    transition: color 0.3s ease;
}

#timer-text.warning {
    color: #FF9800;
    animation: timerPulse 0.5s infinite;
}

#timer-text.danger {
    color: #F44336;
    animation: timerPulse 0.3s infinite;
}

@keyframes timerPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}

.timer-bar {
    width: 120px;
    height: 8px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 4px;
    overflow: hidden;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.2);
}

.timer-progress {
    height: 100%;
    background: linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%);
    border-radius: 4px;
    width: 100%;
    transition: width 0.1s linear, background 0.3s ease;
}

.timer-progress.warning {
    background: linear-gradient(90deg, #FF9800 0%, #FFC107 100%);
}

.timer-progress.danger {
    background: linear-gradient(90deg, #F44336 0%, #FF5722 100%);
    animation: dangerFlash 0.5s infinite;
}

@keyframes dangerFlash {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
}

.score {
    display: flex;
    gap: 30px;
    font-size: 1.2rem;
    font-weight: bold;
}

/* Modal Styles */
.modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.8);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    padding: 20px;
}

.modal.show {
    display: flex;
}

.modal-content {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    padding: 30px;
    text-align: center;
    max-width: 300px;
    width: 100%;
    color: #333;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.modal-content h2 {
    margin-bottom: 10px;
    font-size: 1.8rem;
}

.modal-content p {
    margin-bottom: 25px;
    opacity: 0.8;
}

.modal-buttons {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.modal-btn {
    padding: 12px 20px;
    border: none;
    border-radius: 10px;
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s ease;
    font-weight: bold;
}

.modal-btn.primary {
    background: #3498db;
    color: white;
}

.modal-btn.primary:hover, .modal-btn.primary:active {
    background: #2980b9;
}

.modal-btn.secondary {
    background: #ecf0f1;
    color: #333;
}

.modal-btn.secondary:hover, .modal-btn.secondary:active {
    background: #bdc3c7;
}

/* Elemental Theme Styles */

/* Wind Theme (Floors 1-5) */
.theme-wind {
    background: linear-gradient(135deg, #87CEEB 0%, #E0F6FF 50%, #B0E0E6 100%);
    position: relative;
}

.theme-wind::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="20" r="2" fill="white" opacity="0.3"/><circle cx="80" cy="30" r="1.5" fill="white" opacity="0.4"/><circle cx="60" cy="70" r="1" fill="white" opacity="0.5"/></svg>');
    animation: windParticles 8s linear infinite;
    pointer-events: none;
}

.theme-wind .ttt-grid, .theme-wind .c4-grid {
    background: rgba(255, 255, 255, 0.9);
    border: 3px solid #87CEEB;
    box-shadow: 0 0 20px rgba(135, 206, 235, 0.5);
}

.theme-wind .cell, .theme-wind .c4-cell {
    background: rgba(255, 255, 255, 0.8);
    border-color: #87CEEB;
}

/* Water Theme (Floors 6-10) */
.theme-water {
    background: linear-gradient(135deg, #006994 0%, #0EA5E9 50%, #38BDF8 100%);
    position: relative;
}

.theme-water::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 30% 20%, rgba(255,255,255,0.2) 2px, transparent 2px),
                radial-gradient(circle at 70% 60%, rgba(255,255,255,0.15) 1px, transparent 1px);
    animation: waterBubbles 6s ease-in-out infinite;
    pointer-events: none;
}

.theme-water .ttt-grid, .theme-water .c4-grid {
    background: rgba(255, 255, 255, 0.9);
    border: 3px solid #0EA5E9;
    box-shadow: 0 0 20px rgba(14, 165, 233, 0.7);
}

.theme-water .cell, .theme-water .c4-cell {
    background: rgba(255, 255, 255, 0.8);
    border-color: #0EA5E9;
}

/* Earth Theme (Floors 11-15) */
.theme-earth {
    background: linear-gradient(135deg, #8B4513 0%, #A0522D 50%, #D2B48C 100%);
    position: relative;
}

.theme-earth .ttt-grid, .theme-earth .c4-grid {
    background: rgba(245, 245, 220, 0.95);
    border: 3px solid #8B4513;
    box-shadow: 0 0 20px rgba(139, 69, 19, 0.6);
}

.theme-earth .cell, .theme-earth .c4-cell {
    background: rgba(245, 245, 220, 0.9);
    border-color: #8B4513;
}

/* Fire Theme (Floors 16-20) */
.theme-fire {
    background: linear-gradient(135deg, #DC2626 0%, #EA580C 30%, #F59E0B 60%, #EF4444 100%);
    position: relative;
}

.theme-fire::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 20% 80%, rgba(255,100,0,0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255,69,0,0.2) 0%, transparent 50%);
    animation: fireFlicker 3s ease-in-out infinite alternate;
    pointer-events: none;
}

.theme-fire .ttt-grid, .theme-fire .c4-grid {
    background: rgba(255, 248, 220, 0.95);
    border: 3px solid #DC2626;
    box-shadow: 0 0 30px rgba(220, 38, 38, 0.8);
}

.theme-fire .cell, .theme-fire .c4-cell {
    background: rgba(255, 248, 220, 0.9);
    border-color: #DC2626;
}

/* Lightning Theme (Floors 21-25) */
.theme-lightning {
    background: linear-gradient(135deg, #1E1B4B 0%, #312E81 50%, #4C1D95 100%);
    position: relative;
}

.theme-lightning::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(45deg, transparent 30%, rgba(255,255,0,0.1) 50%, transparent 70%);
    animation: lightningBolt 4s ease-in-out infinite;
    pointer-events: none;
}

.theme-lightning .ttt-grid, .theme-lightning .c4-grid {
    background: rgba(255, 255, 255, 0.95);
    border: 3px solid #FBBF24;
    box-shadow: 0 0 25px rgba(251, 191, 36, 0.8);
}

.theme-lightning .cell, .theme-lightning .c4-cell {
    background: rgba(255, 255, 255, 0.9);
    border-color: #FBBF24;
}

/* Toxin Theme (Floors 26-30) */
.theme-toxin {
    background: linear-gradient(135deg, #15803D 0%, #22C55E 50%, #4ADE80 100%);
    position: relative;
    overflow: hidden;
}

.theme-toxin::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 40% 30%, rgba(0,255,0,0.15) 0%, transparent 60%),
                radial-gradient(circle at 80% 70%, rgba(50,205,50,0.1) 0%, transparent 50%);
    animation: toxinBubbles 5s ease-in-out infinite;
    pointer-events: none;
}

.theme-toxin .ttt-grid, .theme-toxin .c4-grid {
    background: rgba(240, 253, 244, 0.95);
    border: 3px solid #15803D;
    box-shadow: 0 0 30px rgba(21, 128, 61, 0.9), inset 0 0 20px rgba(34, 197, 94, 0.3);
    position: relative;
}

.theme-toxin .cell, .theme-toxin .c4-cell {
    background: rgba(240, 253, 244, 0.9);
    border-color: #15803D;
}

/* Snake Animation for Toxin Theme */
.snake-container {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 1;
}

.snake {
    position: absolute;
    width: 100%;
    height: 100%;
}

.snake-segment {
    position: absolute;
    width: 8px;
    height: 8px;
    background: linear-gradient(45deg, #059669, #10B981);
    border-radius: 50%;
    box-shadow: 0 0 8px rgba(5, 150, 105, 0.6);
}

.snake-head {
    width: 12px;
    height: 12px;
    background: linear-gradient(45deg, #047857, #059669);
    border-radius: 60% 40%;
}

/* Theme Animations */
@keyframes windParticles {
    0% { transform: translateX(-100px) translateY(0px); }
    100% { transform: translateX(calc(100vw + 100px)) translateY(-50px); }
}

@keyframes waterBubbles {
    0%, 100% { transform: translateY(0px) scale(1); opacity: 0.6; }
    50% { transform: translateY(-20px) scale(1.1); opacity: 0.8; }
}

@keyframes fireFlicker {
    0% { transform: scale(1) rotate(0deg); opacity: 0.8; }
    100% { transform: scale(1.05) rotate(1deg); opacity: 1; }
}

@keyframes lightningBolt {
    0%, 90%, 100% { opacity: 0; transform: translateX(0); }
    10%, 80% { opacity: 1; transform: translateX(10px); }
}

@keyframes toxinBubbles {
    0%, 100% { transform: scale(1); opacity: 0.3; }
    50% { transform: scale(1.2); opacity: 0.6; }
}

@keyframes snakeMove {
    0% { transform: translateX(-20px) translateY(0px) rotate(0deg); }
    25% { transform: translateX(50%) translateY(-10px) rotate(90deg); }
    50% { transform: translateX(calc(100% + 20px)) translateY(0px) rotate(180deg); }
    75% { transform: translateX(50%) translateY(10px) rotate(270deg); }
    100% { transform: translateX(-20px) translateY(0px) rotate(360deg); }
}

/* Wind Blow Effect Animation */
.wind-blown {
    animation: windBlowAway 1.5s ease-out forwards;
    z-index: 10;
}

@keyframes windBlowAway {
    0% { 
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }
    20% { 
        transform: scale(1.3) rotate(25deg);
        opacity: 0.9;
    }
    50% { 
        transform: scale(0.9) rotate(-20deg) translateX(40px) translateY(-20px);
        opacity: 0.6;
    }
    80% { 
        transform: scale(0.5) rotate(60deg) translateX(80px) translateY(-40px);
        opacity: 0.2;
    }
    100% { 
        transform: scale(0.2) rotate(120deg) translateX(150px) translateY(-80px);
        opacity: 0;
    }
}

/* Full Screen Wind Storm Effect */
.wind-storm-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 999;
    background: linear-gradient(45deg, 
        transparent 0%, 
        rgba(135, 206, 235, 0.1) 25%, 
        rgba(173, 216, 230, 0.15) 50%, 
        transparent 75%, 
        rgba(173, 216, 230, 0.1) 100%);
    animation: windStormPulse 2s ease-in-out infinite;
}

@keyframes windStormPulse {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.7; }
}

/* Wind Particles */
.wind-particle {
    position: absolute;
    font-size: 2rem;
    animation: windParticleFly 3s linear infinite;
    filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
}

@keyframes windParticleFly {
    0% { 
        transform: translateX(0) translateY(0) rotate(0deg) scale(0.5);
        opacity: 0;
    }
    10% { 
        opacity: 1;
        transform: translateX(50px) translateY(-10px) rotate(45deg) scale(1);
    }
    50% { 
        transform: translateX(50vw) translateY(-30px) rotate(180deg) scale(1.2);
        opacity: 0.8;
    }
    90% { 
        opacity: 0.4;
        transform: translateX(calc(100vw - 50px)) translateY(-60px) rotate(315deg) scale(0.8);
    }
    100% { 
        transform: translateX(100vw) translateY(-80px) rotate(360deg) scale(0.3);
        opacity: 0;
    }
}

/* Wind Lines */
.wind-line {
    position: absolute;
    width: 100px;
    height: 2px;
    background: linear-gradient(90deg, transparent, rgba(173, 216, 230, 0.6), transparent);
    animation: windLineSweep 2s ease-in-out infinite;
    border-radius: 2px;
}

@keyframes windLineSweep {
    0% { 
        transform: translateX(-100px) scaleX(0.5);
        opacity: 0;
    }
    20% { 
        opacity: 1;
        transform: translateX(10vw) scaleX(1);
    }
    80% { 
        opacity: 0.8;
        transform: translateX(80vw) scaleX(1.5);
    }
    100% { 
        transform: translateX(100vw) scaleX(0.3);
        opacity: 0;
    }
}

/* Board Shaking Effect */
.wind-shake {
    animation: violentShake 3s ease-in-out;
}

@keyframes violentShake {
    0%, 100% { transform: translateX(0) translateY(0) rotate(0deg); }
    2% { transform: translateX(-8px) translateY(-3px) rotate(-1deg); }
    4% { transform: translateX(6px) translateY(4px) rotate(1deg); }
    6% { transform: translateX(-10px) translateY(-2px) rotate(-2deg); }
    8% { transform: translateX(8px) translateY(-4px) rotate(1.5deg); }
    10% { transform: translateX(-6px) translateY(3px) rotate(-1deg); }
    12% { transform: translateX(12px) translateY(-5px) rotate(2deg); }
    14% { transform: translateX(-8px) translateY(2px) rotate(-1.5deg); }
    16% { transform: translateX(5px) translateY(-3px) rotate(1deg); }
    18% { transform: translateX(-7px) translateY(4px) rotate(-1deg); }
    20% { transform: translateX(9px) translateY(-2px) rotate(1.5deg); }
    22% { transform: translateX(-4px) translateY(3px) rotate(-0.5deg); }
    24% { transform: translateX(6px) translateY(-4px) rotate(1deg); }
    26% { transform: translateX(-8px) translateY(1px) rotate(-1deg); }
    28% { transform: translateX(3px) translateY(-2px) rotate(0.5deg); }
    30% { transform: translateX(-5px) translateY(3px) rotate(-0.8deg); }
    35% { transform: translateX(4px) translateY(-2px) rotate(0.6deg); }
    40% { transform: translateX(-3px) translateY(2px) rotate(-0.4deg); }
    45% { transform: translateX(2px) translateY(-1px) rotate(0.3deg); }
    50% { transform: translateX(-2px) translateY(1px) rotate(-0.2deg); }
    60% { transform: translateX(1px) translateY(-1px) rotate(0.1deg); }
    70% { transform: translateX(-1px) translateY(0px) rotate(-0.1deg); }
    80% { transform: translateX(0px) translateY(0px) rotate(0deg); }
}

/* Enhanced styling for wind theme pieces */
.theme-wind .cell {
    transition: all 0.3s ease;
}

.theme-wind .cell:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 12px rgba(135, 206, 235, 0.3);
}

/* Wind Protection Minigame Targets */
.wind-protection-target {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(45deg, #4FC3F7, #81C784);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 4px 20px rgba(79, 195, 247, 0.6);
    border: 3px solid #fff;
    animation: windTargetPulse 1s ease-in-out infinite;
    transition: all 0.3s ease;
}

.wind-protection-target:hover {
    transform: scale(1.2);
    box-shadow: 0 6px 25px rgba(79, 195, 247, 0.8);
}

.wind-protection-target.clicked {
    background: linear-gradient(45deg, #4CAF50, #66BB6A);
    animation: windTargetSuccess 0.5s ease-out;
    transform: scale(1.1);
    box-shadow: 0 4px 20px rgba(76, 175, 80, 0.6);
}

@keyframes windTargetPulse {
    0% { 
        transform: scale(1);
        box-shadow: 0 4px 20px rgba(79, 195, 247, 0.6);
    }
    50% { 
        transform: scale(1.1);
        box-shadow: 0 6px 30px rgba(79, 195, 247, 0.8);
    }
    100% { 
        transform: scale(1);
        box-shadow: 0 4px 20px rgba(79, 195, 247, 0.6);
    }
}

@keyframes windTargetSuccess {
    0% { 
        transform: scale(1.1);
        background: linear-gradient(45deg, #4FC3F7, #81C784);
    }
    50% { 
        transform: scale(1.3);
        background: linear-gradient(45deg, #4CAF50, #66BB6A);
    }
    100% { 
        transform: scale(1.1);
        background: linear-gradient(45deg, #4CAF50, #66BB6A);
    }
}

/* Water Flood Effect */
.water-flood-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 999;
    background: linear-gradient(180deg, 
        transparent 0%, 
        rgba(0, 123, 191, 0.1) 25%, 
        rgba(64, 162, 216, 0.2) 50%, 
        rgba(0, 123, 191, 0.15) 75%, 
        rgba(64, 162, 216, 0.1) 100%);
    animation: waterFloodPulse 2.5s ease-in-out infinite;
}

@keyframes waterFloodPulse {
    0%, 100% { opacity: 0.4; }
    50% { opacity: 0.8; }
}

/* Water Particles */
.water-particle {
    position: absolute;
    font-size: 2.5rem;
    animation: waterParticleFlow 4s linear infinite;
    filter: drop-shadow(0 3px 6px rgba(0,123,191,0.4));
}

@keyframes waterParticleFlow {
    0% { 
        transform: translateX(0) translateY(0) rotate(0deg) scale(0.4);
        opacity: 0;
    }
    15% { 
        opacity: 1;
        transform: translateX(80px) translateY(20px) rotate(30deg) scale(1);
    }
    50% { 
        transform: translateX(50vw) translateY(40px) rotate(180deg) scale(1.3);
        opacity: 0.9;
    }
    85% { 
        opacity: 0.5;
        transform: translateX(calc(100vw - 80px)) translateY(60px) rotate(330deg) scale(0.9);
    }
    100% { 
        transform: translateX(100vw) translateY(80px) rotate(360deg) scale(0.2);
        opacity: 0;
    }
}

/* Water Lines */
.water-line {
    position: absolute;
    width: 120px;
    height: 3px;
    background: linear-gradient(90deg, transparent, rgba(64, 162, 216, 0.7), rgba(0, 123, 191, 0.5), transparent);
    animation: waterLineFlow 3s ease-in-out infinite;
    border-radius: 3px;
}

@keyframes waterLineFlow {
    0% { 
        transform: translateX(-120px) scaleX(0.3);
        opacity: 0;
    }
    25% { 
        opacity: 1;
        transform: translateX(15vw) scaleX(1);
    }
    75% { 
        opacity: 0.9;
        transform: translateX(75vw) scaleX(1.8);
    }
    100% { 
        transform: translateX(100vw) scaleX(0.2);
        opacity: 0;
    }
}

/* Water Protection Minigame Targets */
.water-protection-target {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    background: linear-gradient(45deg, #40A2D8, #0077BE, #87CEEB);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.8rem;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 5px 25px rgba(64, 162, 216, 0.7);
    border: 4px solid rgba(255, 255, 255, 0.8);
    animation: bubbleBob 1.5s ease-in-out infinite;
    transition: all 0.3s ease;
    position: relative;
}

.water-protection-target::before {
    content: '';
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(135, 206, 235, 0.3) 0%, transparent 70%);
    z-index: -1;
    animation: bubbleGlow 2s ease-in-out infinite;
}

.water-protection-target:hover {
    transform: scale(1.15);
    box-shadow: 0 7px 35px rgba(64, 162, 216, 0.9);
}

.water-protection-target.bubble-popped {
    background: linear-gradient(45deg, #FF6B6B, #FF8E53, #FF6B6B);
    animation: bubblePop 0.6s ease-out forwards;
    box-shadow: 0 5px 25px rgba(255, 107, 107, 0.7);
}

@keyframes bubbleBob {
    0%, 100% { 
        transform: translateY(0) scale(1);
        box-shadow: 0 5px 25px rgba(64, 162, 216, 0.7);
    }
    50% { 
        transform: translateY(-8px) scale(1.05);
        box-shadow: 0 8px 30px rgba(64, 162, 216, 0.8);
    }
}

@keyframes bubbleGlow {
    0%, 100% { opacity: 0.3; }
    50% { opacity: 0.6; }
}

@keyframes bubblePop {
    0% { 
        transform: scale(1.2);
        background: linear-gradient(45deg, #40A2D8, #0077BE, #87CEEB);
    }
    30% { 
        transform: scale(1.4);
        background: linear-gradient(45deg, #FF6B6B, #FF8E53, #FFD93D);
    }
    60% { 
        transform: scale(1.1);
        background: linear-gradient(45deg, #FF6B6B, #FF8E53, #FF6B6B);
    }
    100% { 
        transform: scale(0);
        background: linear-gradient(45deg, #FF6B6B, #FF8E53, #FF6B6B);
    }
}

/* Water Wash Effect Animation */
.water-washed {
    animation: waterWashAway 1.5s ease-out forwards;
    z-index: 10;
}

@keyframes waterWashAway {
    0% { 
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }
    25% { 
        transform: scale(1.2) rotate(-15deg);
        opacity: 0.8;
    }
    50% { 
        transform: scale(0.8) rotate(25deg) translateX(-30px) translateY(40px);
        opacity: 0.5;
    }
    80% { 
        transform: scale(0.4) rotate(-45deg) translateX(-80px) translateY(100px);
        opacity: 0.2;
    }
    100% { 
        transform: scale(0.1) rotate(-90deg) translateX(-150px) translateY(200px);
        opacity: 0;
    }
}

/* Earth Earthquake Effect */
.earth-quake-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 999;
    background: linear-gradient(135deg, 
        transparent 0%, 
        rgba(101, 67, 33, 0.1) 20%, 
        rgba(139, 69, 19, 0.2) 40%, 
        rgba(160, 82, 45, 0.15) 60%, 
        rgba(101, 67, 33, 0.1) 80%, 
        transparent 100%);
    animation: earthquakePulse 2s ease-in-out infinite;
}

@keyframes earthquakePulse {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 0.9; }
}

/* Earth Particles */
.earth-particle {
    position: absolute;
    font-size: 2.8rem;
    animation: earthParticleRumble 3.5s linear infinite;
    filter: drop-shadow(0 4px 8px rgba(101,67,33,0.5));
}

@keyframes earthParticleRumble {
    0% { 
        transform: translateX(0) translateY(0) rotate(0deg) scale(0.3);
        opacity: 0;
    }
    20% { 
        opacity: 1;
        transform: translateX(100px) translateY(-20px) rotate(45deg) scale(1);
    }
    50% { 
        transform: translateX(50vw) translateY(30px) rotate(180deg) scale(1.4);
        opacity: 0.9;
    }
    80% { 
        opacity: 0.6;
        transform: translateX(calc(100vw - 100px)) translateY(-10px) rotate(315deg) scale(1);
    }
    100% { 
        transform: translateX(100vw) translateY(-50px) rotate(360deg) scale(0.2);
        opacity: 0;
    }
}

/* Earth Crack Lines */
.earth-crack-line {
    position: absolute;
    width: 150px;
    height: 4px;
    background: linear-gradient(90deg, transparent, rgba(139, 69, 19, 0.8), rgba(101, 67, 33, 0.6), transparent);
    animation: earthCrackSpread 2.5s ease-in-out infinite;
    border-radius: 2px;
}

@keyframes earthCrackSpread {
    0% { 
        transform: translateX(-150px) scaleX(0.2);
        opacity: 0;
    }
    30% { 
        opacity: 1;
        transform: translateX(20vw) scaleX(1);
    }
    70% { 
        opacity: 0.8;
        transform: translateX(70vw) scaleX(2);
    }
    100% { 
        transform: translateX(100vw) scaleX(0.1);
        opacity: 0;
    }
}

/* Earth Protection Minigame Targets */
.earth-protection-target {
    width: 75px;
    height: 75px;
    border-radius: 15px;
    background: linear-gradient(45deg, #8B4513, #A0522D, #CD853F, #DEB887);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.6rem;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 6px 30px rgba(139, 69, 19, 0.8);
    border: 5px solid rgba(222, 184, 135, 0.9);
    animation: crystalGlimmer 1.8s ease-in-out infinite;
    transition: all 0.3s ease;
    position: relative;
}

.earth-protection-target::before {
    content: '';
    position: absolute;
    top: -8px;
    left: -8px;
    right: -8px;
    bottom: -8px;
    border-radius: 20px;
    background: radial-gradient(circle, rgba(222, 184, 135, 0.4) 0%, transparent 70%);
    z-index: -1;
    animation: crystalAura 2.5s ease-in-out infinite;
}

.earth-protection-target:hover {
    transform: scale(1.1) rotateY(15deg);
    box-shadow: 0 8px 40px rgba(139, 69, 19, 1);
}

.earth-protection-target.crystal-broken {
    background: linear-gradient(45deg, #FF4500, #FF6347, #FF8C00);
    animation: crystalShatter 0.7s ease-out;
    transform: scale(1.15);
    box-shadow: 0 6px 30px rgba(255, 69, 0, 0.8);
}

@keyframes crystalGlimmer {
    0%, 100% { 
        transform: scale(1) rotateX(0deg);
        box-shadow: 0 6px 30px rgba(139, 69, 19, 0.8);
    }
    50% { 
        transform: scale(1.05) rotateX(5deg);
        box-shadow: 0 8px 35px rgba(139, 69, 19, 1);
    }
}

@keyframes crystalAura {
    0%, 100% { opacity: 0.4; }
    50% { opacity: 0.7; }
}

@keyframes crystalShatter {
    0% { 
        transform: scale(1.15);
        background: linear-gradient(45deg, #8B4513, #A0522D, #CD853F, #DEB887);
    }
    25% { 
        transform: scale(1.3) rotate(5deg);
        background: linear-gradient(45deg, #FF4500, #FF6347, #FFD700);
    }
    50% { 
        transform: scale(1.1) rotate(-3deg);
        background: linear-gradient(45deg, #FF4500, #FF6347, #FF8C00);
    }
    100% { 
        transform: scale(1.15);
        background: linear-gradient(45deg, #FF4500, #FF6347, #FF8C00);
    }
}

/* Earth Crush Effect Animation */
.earth-crushed {
    animation: earthCrushAway 1.5s ease-out forwards;
    z-index: 10;
}

@keyframes earthCrushAway {
    0% { 
        transform: scale(1) rotate(0deg);
        opacity: 1;
    }
    20% { 
        transform: scale(1.1) rotate(10deg);
        opacity: 0.9;
    }
    40% { 
        transform: scale(0.9) rotate(-25deg) translateY(20px);
        opacity: 0.7;
    }
    70% { 
        transform: scale(0.5) rotate(45deg) translateY(60px);
        opacity: 0.3;
    }
    100% { 
        transform: scale(0.1) rotate(90deg) translateY(120px);
        opacity: 0;
    }
}

/* Fire Blaze Effect */
.fire-blaze-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    pointer-events: none;
    z-index: 999;
    background: linear-gradient(135deg, 
        transparent 0%, 
        rgba(255, 69, 0, 0.15) 20%, 
        rgba(255, 140, 0, 0.25) 40%, 
        rgba(220, 20, 60, 0.2) 60%, 
        rgba(255, 69, 0, 0.15) 80%, 
        transparent 100%);
    animation: fireBlazePulse 1.8s ease-in-out infinite;
}

@keyframes fireBlazePulse {
    0%, 100% { opacity: 0.6; }
    50% { opacity: 1; }
}

/* Fire Particles */
.fire-particle {
    position: absolute;
    font-size: 3rem;
    animation: fireParticleRage 3s linear infinite;
    filter: drop-shadow(0 5px 10px rgba(255,69,0,0.6));
}

@keyframes fireParticleRage {
    0% { 
        transform: translateX(0) translateY(0) rotate(0deg) scale(0.2);
        opacity: 0;
    }
    25% { 
        opacity: 1;
        transform: translateX(120px) translateY(-30px) rotate(60deg) scale(1);
    }
    50% { 
        transform: translateX(50vw) translateY(20px) rotate(180deg) scale(1.5);
        opacity: 0.9;
    }
    75% { 
        opacity: 0.7;
        transform: translateX(calc(100vw - 120px)) translateY(-40px) rotate(300deg) scale(1.1);
    }
    100% { 
        transform: translateX(100vw) translateY(-70px) rotate(360deg) scale(0.1);
        opacity: 0;
    }
}

/* Flame Lines */
.flame-line {
    position: absolute;
    width: 180px;
    height: 5px;
    background: linear-gradient(90deg, transparent, rgba(255, 69, 0, 0.9), rgba(255, 140, 0, 0.7), transparent);
    animation: flameLineRoar 2s ease-in-out infinite;
    border-radius: 3px;
}

@keyframes flameLineRoar {
    0% { 
        transform: translateX(-180px) scaleX(0.1);
        opacity: 0;
    }
    35% { 
        opacity: 1;
        transform: translateX(25vw) scaleX(1);
    }
    65% { 
        opacity: 0.9;
        transform: translateX(65vw) scaleX(2.5);
    }
    100% { 
        transform: translateX(100vw) scaleX(0.05);
        opacity: 0;
    }
}

/* Fire Protection Minigame Targets */
.fire-protection-target {
    width: 80px;
    height: 80px;
    border-radius: 20px;
    background: linear-gradient(45deg, #FF4500, #FF6347, #FF8C00, #FFD700);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.4rem;
    cursor: pointer;
    user-select: none;
    box-shadow: 0 7px 35px rgba(255, 69, 0, 0.9);
    border: 6px solid rgba(255, 215, 0, 0.8);
    animation: torchFlicker 1.2s ease-in-out infinite;
    transition: all 0.3s ease;
    position: relative;
}

.fire-protection-target::before {
    content: '';
    position: absolute;
    top: -10px;
    left: -10px;
    right: -10px;
    bottom: -10px;
    border-radius: 25px;
    background: radial-gradient(circle, rgba(255, 215, 0, 0.5) 0%, transparent 70%);
    z-index: -1;
    animation: torchHeat 2s ease-in-out infinite;
}

.fire-protection-target:hover {
    transform: scale(1.12) rotateZ(8deg);
    box-shadow: 0 10px 45px rgba(255, 69, 0, 1);
}

.fire-protection-target.torch-extinguished {
    background: linear-gradient(45deg, #708090, #A9A9A9, #C0C0C0);
    animation: torchExtinguish 0.8s ease-out;
    transform: scale(1.1);
    box-shadow: 0 7px 35px rgba(105, 105, 105, 0.7);
}

@keyframes torchFlicker {
    0%, 100% { 
        transform: scale(1) rotate(0deg);
        box-shadow: 0 7px 35px rgba(255, 69, 0, 0.9);
    }
    25% { 
        transform: scale(1.03) rotate(2deg);
        box-shadow: 0 9px 40px rgba(255, 69, 0, 1);
    }
    75% { 
        transform: scale(1.06) rotate(-1deg);
        box-shadow: 0 8px 38px rgba(255, 140, 0, 0.95);
    }
}

@keyframes torchHeat {
    0%, 100% { opacity: 0.5; }
    50% { opacity: 0.8; }
}

@keyframes torchExtinguish {
    0% { 
        transform: scale(1.1);
        background: linear-gradient(45deg, #FF4500, #FF6347, #FF8C00, #FFD700);
    }
    30% { 
        transform: scale(1.25) rotate(8deg);
        background: linear-gradient(45deg, #A9A9A9, #D3D3D3, #E0E0E0);
    }
    70% { 
        transform: scale(1.05) rotate(-3deg);
        background: linear-gradient(45deg, #708090, #A9A9A9, #C0C0C0);
    }
    100% { 
        transform: scale(1.1);
        background: linear-gradient(45deg, #708090, #A9A9A9, #C0C0C0);
    }
}

/* Fire Burn Effect Animation */
.fire-burned {
    animation: fireBurnEffect 1s ease-out forwards;
}

@keyframes fireBurnEffect {
    0% { transform: scale(1) rotate(0deg); color: #ff6b35; }
    25% { transform: scale(1.3) rotate(5deg); color: #ff4500; }
    50% { transform: scale(0.8) rotate(-10deg); color: #dc143c; }
    75% { transform: scale(1.1) rotate(8deg); color: #8b0000; }
    100% { transform: scale(0) rotate(360deg); opacity: 0; color: #2c1810; }
}

/* Lightning Storm Effects */
.lightning-storm-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: linear-gradient(45deg, 
        rgba(0, 0, 0, 0.85) 0%, 
        rgba(25, 25, 112, 0.9) 25%, 
        rgba(75, 0, 130, 0.8) 50%, 
        rgba(138, 43, 226, 0.85) 75%, 
        rgba(0, 0, 0, 0.9) 100%);
    z-index: 998;
    pointer-events: none;
    animation: lightningStormPulse 2s ease-in-out infinite alternate;
}

@keyframes lightningStormPulse {
    0% { opacity: 0.7; filter: brightness(1); }
    100% { opacity: 0.95; filter: brightness(1.3) contrast(1.2); }
}

.lightning-particle {
    position: absolute;
    font-size: 24px;
    animation: lightningParticleFloat 2.5s linear infinite;
    pointer-events: none;
    text-shadow: 0 0 15px #ffff00, 0 0 25px #ffffff, 0 0 35px #add8e6;
    z-index: 999;
}

@keyframes lightningParticleFloat {
    0% { 
        transform: translateX(0) translateY(0) rotate(0deg) scale(0.8); 
        opacity: 0;
    }
    10% { 
        opacity: 1; 
        transform: translateX(20vw) translateY(-10px) rotate(45deg) scale(1);
    }
    90% { 
        opacity: 0.8; 
        transform: translateX(95vw) translateY(-50px) rotate(180deg) scale(1.2);
    }
    100% { 
        transform: translateX(110vw) translateY(-80px) rotate(360deg) scale(0.5); 
        opacity: 0;
    }
}

.lightning-bolt-line {
    position: absolute;
    width: 100vw;
    height: 3px;
    background: linear-gradient(90deg, 
        transparent 0%, 
        #ffff00 10%, 
        #ffffff 50%, 
        #add8e6 90%, 
        transparent 100%);
    animation: lightningBoltSweep 1.8s ease-in-out infinite;
    pointer-events: none;
    box-shadow: 0 0 20px #ffff00, 0 0 40px #ffffff;
    z-index: 999;
}

@keyframes lightningBoltSweep {
    0% { 
        transform: translateX(-100vw) skewX(30deg); 
        opacity: 0;
        filter: brightness(1);
    }
    15% { 
        opacity: 0.9; 
        transform: translateX(-50vw) skewX(15deg);
        filter: brightness(1.5);
    }
    85% { 
        opacity: 0.7; 
        transform: translateX(50vw) skewX(-15deg);
        filter: brightness(1.8);
    }
    100% { 
        transform: translateX(100vw) skewX(-30deg); 
        opacity: 0;
        filter: brightness(1);
    }
}

/* Lightning Protection Targets */
.lightning-protection-target {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: radial-gradient(circle, #ffff00 0%, #ffd700 40%, #4169e1 100%);
    border: 3px solid #ffffff;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    cursor: pointer;
    user-select: none;
    animation: lightningTargetPulse 1.2s ease-in-out infinite alternate;
    box-shadow: 
        0 0 15px #ffff00, 
        0 0 25px #add8e6, 
        0 0 35px #4169e1,
        inset 0 0 10px rgba(255, 255, 255, 0.3);
    transition: all 0.2s ease;
}

@keyframes lightningTargetPulse {
    0% { 
        transform: scale(1) rotate(0deg); 
        box-shadow: 
            0 0 15px #ffff00, 
            0 0 25px #add8e6, 
            0 0 35px #4169e1;
    }
    100% { 
        transform: scale(1.15) rotate(10deg); 
        box-shadow: 
            0 0 25px #ffff00, 
            0 0 35px #add8e6, 
            0 0 45px #4169e1,
            0 0 55px #ffffff;
    }
}

.lightning-protection-target:hover {
    transform: scale(1.25) rotate(15deg);
    box-shadow: 
        0 0 30px #ffff00, 
        0 0 40px #add8e6, 
        0 0 50px #4169e1,
        0 0 60px #ffffff;
}

.lightning-protection-target.rod-discharged {
    background: radial-gradient(circle, #ff4500 0%, #ff6b35 40%, #8b0000 100%);
    animation: lightningTargetDischarge 0.6s ease-out forwards;
    box-shadow: 
        0 0 20px #ff4500, 
        0 0 30px #ff6b35, 
        0 0 40px #ffffff;
}

@keyframes lightningTargetDischarge {
    0% { 
        transform: scale(1) rotate(0deg); 
        opacity: 1;
    }
    50% { 
        transform: scale(1.5) rotate(180deg); 
        opacity: 0.8;
        box-shadow: 
            0 0 30px #ff4500, 
            0 0 50px #ff6b35, 
            0 0 70px #ffffff;
    }
    100% { 
        transform: scale(0.3) rotate(360deg); 
        opacity: 0.3;
        box-shadow: 
            0 0 10px #8b0000;
    }
}

/* Lightning Zap Effect Animation */
.lightning-zapped {
    animation: lightningZapEffect 1s ease-out forwards;
}

@keyframes lightningZapEffect {
    0% { transform: scale(1) rotate(0deg); color: #ffff00; }
    25% { transform: scale(1.4) rotate(15deg); color: #add8e6; }
    50% { transform: scale(0.7) rotate(-20deg); color: #4169e1; }
    75% { transform: scale(1.2) rotate(25deg); color: #0000ff; }
    100% { transform: scale(0) rotate(720deg); opacity: 0; color: #191970; }
}

/* Toxin Cloud Effects */
.toxin-cloud-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: linear-gradient(45deg, 
        rgba(0, 0, 0, 0.9) 0%, 
        rgba(34, 139, 34, 0.85) 15%, 
        rgba(124, 252, 0, 0.8) 35%, 
        rgba(50, 205, 50, 0.9) 65%, 
        rgba(0, 100, 0, 0.85) 85%, 
        rgba(0, 0, 0, 0.9) 100%);
    z-index: 998;
    pointer-events: none;
    animation: toxinCloudPulse 2.2s ease-in-out infinite alternate;
}

@keyframes toxinCloudPulse {
    0% { opacity: 0.75; filter: brightness(1.1) hue-rotate(0deg); }
    100% { opacity: 0.95; filter: brightness(1.4) contrast(1.3) hue-rotate(30deg); }
}

.toxin-particle {
    position: absolute;
    font-size: 26px;
    animation: toxinParticleFloat 3s linear infinite;
    pointer-events: none;
    text-shadow: 0 0 20px #32cd32, 0 0 30px #7cfc00, 0 0 40px #00ff00;
    z-index: 999;
}

@keyframes toxinParticleFloat {
    0% { 
        transform: translateX(0) translateY(0) rotate(0deg) scale(0.7); 
        opacity: 0;
    }
    15% { 
        opacity: 1; 
        transform: translateX(25vw) translateY(-20px) rotate(60deg) scale(1.1);
    }
    85% { 
        opacity: 0.9; 
        transform: translateX(90vw) translateY(-60px) rotate(240deg) scale(1.3);
    }
    100% { 
        transform: translateX(110vw) translateY(-100px) rotate(360deg) scale(0.4); 
        opacity: 0;
    }
}

.toxin-gas-stream {
    position: absolute;
    width: 100vw;
    height: 4px;
    background: linear-gradient(90deg, 
        transparent 0%, 
        #32cd32 15%, 
        #7cfc00 50%, 
        #00ff00 85%, 
        transparent 100%);
    animation: toxinGasStreamSweep 2s ease-in-out infinite;
    pointer-events: none;
    box-shadow: 0 0 25px #32cd32, 0 0 45px #7cfc00;
    z-index: 999;
}

@keyframes toxinGasStreamSweep {
    0% { 
        transform: translateX(-110vw) skewX(45deg); 
        opacity: 0;
        filter: brightness(1.2);
    }
    20% { 
        opacity: 0.8; 
        transform: translateX(-60vw) skewX(25deg);
        filter: brightness(1.8);
    }
    80% { 
        opacity: 0.9; 
        transform: translateX(60vw) skewX(-25deg);
        filter: brightness(2);
    }
    100% { 
        transform: translateX(110vw) skewX(-45deg); 
        opacity: 0;
        filter: brightness(1.2);
    }
}

/* Toxin Protection Targets */
.toxin-protection-target {
    width: 65px;
    height: 65px;
    border-radius: 50%;
    background: radial-gradient(circle, #32cd32 0%, #7cfc00 50%, #006400 100%);
    border: 4px solid #00ff00;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    cursor: pointer;
    user-select: none;
    animation: toxinTargetPulse 1s ease-in-out infinite alternate;
    box-shadow: 
        0 0 20px #32cd32, 
        0 0 30px #7cfc00, 
        0 0 40px #00ff00,
        inset 0 0 15px rgba(0, 255, 0, 0.4);
    transition: all 0.3s ease;
}

@keyframes toxinTargetPulse {
    0% { 
        transform: scale(1) rotate(0deg); 
        box-shadow: 
            0 0 20px #32cd32, 
            0 0 30px #7cfc00, 
            0 0 40px #00ff00;
    }
    100% { 
        transform: scale(1.2) rotate(15deg); 
        box-shadow: 
            0 0 30px #32cd32, 
            0 0 40px #7cfc00, 
            0 0 50px #00ff00,
            0 0 60px #ffffff;
    }
}

.toxin-protection-target:hover {
    transform: scale(1.3) rotate(20deg);
    box-shadow: 
        0 0 35px #32cd32, 
        0 0 45px #7cfc00, 
        0 0 55px #00ff00,
        0 0 65px #ffffff;
}

.toxin-protection-target.vial-neutralized {
    background: radial-gradient(circle, #87ceeb 0%, #add8e6 50%, #4682b4 100%);
    animation: toxinTargetNeutralize 0.7s ease-out forwards;
    box-shadow: 
        0 0 25px #87ceeb, 
        0 0 35px #add8e6, 
        0 0 45px #4682b4;
}

@keyframes toxinTargetNeutralize {
    0% { 
        transform: scale(1) rotate(0deg); 
        opacity: 1;
    }
    60% { 
        transform: scale(1.6) rotate(270deg); 
        opacity: 0.9;
        box-shadow: 
            0 0 40px #87ceeb, 
            0 0 60px #add8e6, 
            0 0 80px #4682b4;
    }
    100% { 
        transform: scale(0.2) rotate(360deg); 
        opacity: 0.2;
        box-shadow: 
            0 0 15px #4682b4;
    }
}

/* Toxin Poison Effect Animation */
.toxin-poisoned {
    animation: toxinPoisonEffect 1s ease-out forwards;
}

@keyframes toxinPoisonEffect {
    0% { transform: scale(1) rotate(0deg); color: #32cd32; }
    25% { transform: scale(1.5) rotate(20deg); color: #7cfc00; }
    50% { transform: scale(0.6) rotate(-30deg); color: #00ff00; }
    75% { transform: scale(1.3) rotate(40deg); color: #006400; }
    100% { transform: scale(0) rotate(900deg); opacity: 0; color: #003300; }
}

/* Welcome Screen Styles */
#welcome-screen {
    justify-content: center;
    align-items: center;
    text-align: center;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    min-height: 100vh;
}

.welcome-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 50px;
}

.welcome-title {
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
}

.welcome-title h1 {
    font-size: 3rem;
    font-weight: bold;
    margin-bottom: 30px;
    text-shadow: 3px 3px 6px rgba(0,0,0,0.4);
    background: linear-gradient(45deg, #FFD700, #FFA500, #FF6B6B, #4ECDC4, #45B7D1, #96CEB4);
    background-size: 400% 400%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: rainbowGlow 3s ease-in-out infinite;
}

@keyframes rainbowGlow {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
}

.seasonal-icons {
    position: relative;
    width: 200px;
    height: 200px;
    margin: 20px auto;
}

.seasonal-icons .icon {
    position: absolute;
    font-size: 2.5rem;
    animation: circleRotate 15s linear infinite;
    transform-origin: 100px 100px;
    filter: drop-shadow(0 4px 8px rgba(0,0,0,0.3));
}

.seasonal-icons .icon.wind {
    animation-delay: 0s;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
}

.seasonal-icons .icon.water {
    animation-delay: -1.33s;
    top: 25%;
    right: 10%;
}

.seasonal-icons .icon.earth {
    animation-delay: -2.66s;
    top: 75%;
    right: 10%;
}

.seasonal-icons .icon.fire {
    animation-delay: -4s;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
}

.seasonal-icons .icon.lightning {
    animation-delay: -5.33s;
    top: 75%;
    left: 10%;
}

.seasonal-icons .icon.toxin {
    animation-delay: -6.66s;
    top: 25%;
    left: 10%;
}

@keyframes circleRotate {
    0% { transform: translateX(-50%) rotate(0deg) translateX(100px) rotate(0deg); }
    100% { transform: translateX(-50%) rotate(360deg) translateX(100px) rotate(-360deg); }
}

.welcome-btn {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 3px solid rgba(255, 255, 255, 0.3);
    color: white;
    font-size: 1.5rem;
    font-weight: bold;
    padding: 20px 40px;
    border-radius: 50px;
    cursor: pointer;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 2px;
    box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

.welcome-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 35px rgba(0,0,0,0.3);
    border-color: rgba(255, 255, 255, 0.6);
    background: linear-gradient(135deg, #764ba2 0%, #667eea 100%);
}

/* Responsive Design */
@media (max-width: 480px) {
    .container {
        padding: 15px;
    }
    
    #menu-screen h1 {
        font-size: 2rem;
    }
    
    .cell {
        font-size: 2rem;
    }
    
    .game-board {
        margin: 15px 0;
        padding: 10px;
    }
}

/* PWA Specific Styles */
@media (display-mode: standalone) {
    body {
        padding-top: env(safe-area-inset-top);
    }
    
    .container {
        padding-top: calc(20px + env(safe-area-inset-top));
    }
}
